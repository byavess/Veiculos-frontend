<div class="container-concessionaria">
 
 <mat-card class="filtro-card">
 <mat-card-content>
 <h2>Filtros de Busca</h2>
 <div class="filtro-group">
 <mat-form-field appearance="outline">
 <mat-label>Marca/Modelo</mat-label>
 <!-- üõë CORRIGIDO: Usando marcaFiltro.marca, que √© uma string, n√£o o objeto inteiro -->
 <input matInput placeholder="Ex: BMW, Sedan" [(ngModel)]="marcaFiltro.marca"> 
 </mat-form-field>
 <!-- üõë ADICIONADO: Evento de clique para chamar a fun√ß√£o de filtro -->
 <button 
 mat-raised-button 
 color="primary"
 (click)="aplicarFiltros()"
 >
 Buscar
 </button>
 </div>
 </mat-card-content>
 </mat-card>

 <!-- Se√ß√£o de carregamento/erro -->
 <div *ngIf="loading" class="flex justify-center items-center h-40">
 <mat-spinner></mat-spinner>
 <p>Carregando ve√≠culos...</p>
 </div>

 <div *ngIf="erroCarregamento && !loading" class="text-center p-8">
 <mat-card-title>Erro ao carregar</mat-card-title>
 <p>N√£o foi poss√≠vel carregar os ve√≠culos. Verifique a conex√£o com o servidor.</p>
 <button mat-raised-button color="accent" (click)="carregarVeiculos()">Tentar Novamente</button>
 </div>

 <div *ngIf="!loading && veiculos.length === 0" class="text-center p-8">
 <p>Nenhum ve√≠culo encontrado.</p>
 </div>

 <!-- Grid de Ve√≠culos -->
 <div class="veiculos-grid" *ngIf="!loading && veiculos.length > 0">
 <mat-card *ngFor="let veiculo of veiculos" class="veiculo-card">
 
<!-- Tratamento b√°sico para URLs vazias e primeiro √≠ndice -->
<img 
 mat-card-image 
 [src]="veiculo.imagem && veiculo.imagem.length > 0 ? veiculo.imagem[0] : '[https://placehold.co/600x400?text=Sem+Foto](https://placehold.co/600x400?text=Sem+Foto)'" 
 [alt]="veiculo.modelo">
 
 <mat-card-header>
 <mat-card-title>{{ veiculo.marca }} {{ veiculo.modelo }}</mat-card-title>
 <mat-card-subtitle>{{ veiculo.ano }} | {{ veiculo.cor }}</mat-card-subtitle>
 </mat-card-header>

 <mat-card-content>
 <!-- üõë CORRIGIDO: Pipe de formata√ß√£o com locale 'pt' para R$ -->
 <p class="preco">R$ {{ veiculo.preco | number:'1.2-2':'pt' }}</p>
 <p class="descricao">{{ veiculo.descricao }}</p>
 </mat-card-content>

 <mat-card-actions>
 <!-- CORRIGIDO: Usando o nome da rota '/public/details/:id' -->
 <a mat-button color="primary" [routerLink]="['/public/details', veiculo.id]"> 
 VER DETALHES
 </a>
 </mat-card-actions>
 </mat-card>
 </div>
</div>