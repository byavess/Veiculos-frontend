<div class="estoque-container">
  <!-- Cabeçalho -->
  <section class="header-estoque">
    <div class="header-content">
      <h1>Conheça nosso estoque</h1>
      <p class="subtitle">Seu carro dos sonhos está aqui!</p>
    </div>
  </section>

  <!-- Filtros -->
  <section class="filtros-estoque" *ngIf="!loading">
    <div class="filtros-container">
      <form [formGroup]="filtroForm">
        <div class="filtros-grid">
          <!-- Marca -->
          <div class="filtro-group">
            <label for="marca">Marca</label>
            <select id="marca" formControlName="marca" class="filtro-select">
              <option *ngFor="let marca of marcasDisponiveis" [value]="marca">
                {{marca}}
              </option>
            </select>
          </div>

          <!-- Modelo -->
          <div class="filtro-group">
            <label for="modelo">Modelo</label>
            <input 
              id="modelo" 
              type="text" 
              formControlName="modelo" 
              class="filtro-input"
              placeholder="Digite o modelo">
          </div>

          <!-- Ano Mínimo -->
          <div class="filtro-group">
            <label for="anoMin">Ano Mínimo</label>
            <select id="anoMin" formControlName="anoMin" class="filtro-select">
              <option value="">Ex: 2010</option>
              <option *ngFor="let ano of anosDisponiveis" [value]="ano">
                {{ano}}
              </option>
            </select>
          </div>

          <!-- Ano Máximo -->
          <div class="filtro-group">
            <label for="anoMax">Ano Máximo</label>
            <select id="anoMax" formControlName="anoMax" class="filtro-select">
              <option value="">Ex: 2024</option>
              <option *ngFor="let ano of anosDisponiveis" [value]="ano">
                {{ano}}
              </option>
            </select>
          </div>
        </div>

        <!-- Botões -->
        <div class="filtros-botoes">
          <button type="button" class="btn-pesquisar" (click)="aplicarFiltros()">
            PESQUISAR
          </button>
          <button type="button" class="btn-limpar" (click)="limparFiltros()">
            Limpar Filtros
          </button>
        </div>
      </form>
    </div>
  </section>

  <!-- Grid Header -->
  <div class="grid-header" *ngIf="!loading && !erroCarregamento">
    <div>Nome do Veículo</div>
    <div>Faixa de Preço</div>
    <div>Marca</div>
    <div>Modelo</div>
    <div>Ações</div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-estoque">
    <div class="spinner"></div>
    <p>Carregando estoque...</p>
  </div>

  <!-- Erro -->
  <div *ngIf="erroCarregamento && !loading" class="erro-estoque">
    <p>❌ Erro ao carregar estoque. Tente novamente.</p>
    <button (click)="carregarVeiculos()" class="btn-recarregar">
      Recarregar
    </button>
  </div>

  <!-- Grid de Veículos (ESTILO TABELA como na imagem) -->
  div class="vehicles-grid" *ngIf="!loading && !erroCarregamento">
      <mat-card *ngFor="let veiculo of veiculos$ | async" class="vehicle-card">
        <div class="vehicle-image">
          <img
            [src]="veiculo.urlsFotos && veiculo.urlsFotos.length > 0 ? getImagemUrl(veiculo.urlsFotos[0]) : 'https://placehold.co/600x400?text=Sem+Foto'"
            [alt]="veiculo.marca + ' ' + veiculo.modelo"
            class="vehicle-img"
            (error)="onImageError($event)">
          <div class="vehicle-badge">{{ veiculo.ano }}</div>
        </div>

        <mat-card-content class="vehicle-content">
          <h3 class="vehicle-name">{{ veiculo.marca }} {{ veiculo.modelo }}</h3>
          <p class="vehicle-description">{{ veiculo.descricao }}</p>

          <div class="vehicle-details">
            <span class="vehicle-color">
              <mat-icon>palette</mat-icon>
              {{ veiculo.cor || 'Cor não informada' }}
            </span>
          </div>

          <div class="vehicle-price">
            {{ veiculo.preco | currency:'BRL':'symbol':'1.2-2':'pt' }}
          </div>
        </mat-card-content>

        <mat-card-actions class="vehicle-actions">
          <button mat-flat-button color="primary" class="details-btn" [routerLink]="['/details', veiculo.id]">
            <mat-icon>visibility</mat-icon>
            Ver Detalhes
          </button>

  <!-- Botão WhatsApp Flutuante -->
 
 <div>
     <button class="whatsapp-float" (click)="contatoWhatsApp()" 
          aria-label="Fale conosco no WhatsApp">
    <svg class="whatsapp-icon-float" viewBox="0 0 24 24">
      <path fill="currentColor" d="M16.75 13.96c.25.13.41.2.46.3.06.11.04.61-.21 1.18-.2.56-1.24 1.1-1.7 1.12-.46.02-.47.36-2.96-.73-2.49-1.09-3.99-3.75-4.11-3.92-.12-.17-.96-1.38-.92-2.61.05-1.22.69-1.8.95-2.04.24-.26.51-.29.68-.26h.47c.15 0 .36-.06.55.45l.69 1.87c.06.13.1.28.01.44l-.27.41-.39.42c-.12.12-.26.25-.12.5.12.26.62 1.09 1.32 1.78.91.88 1.71 1.17 1.95 1.3.24.14.39.12.54-.04l.81-.94c.19-.25.35-.19.58-.11l1.67.88M12 2a10 10 0 0 1 10 10 10 10 0 0 1-10 10c-1.97 0-3.8-.57-5.35-1.55L2 22l1.55-4.65A9.96 9.96 0 0 1 2 12 10 10 0 0 1 12 2m0 2a8 8 0 0 0-8 8c0 1.72.54 3.31 1.46 4.61L4.5 19.5l2.89-.96A7.95 7.95 0 0 0 12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8z"/>
    </svg>
  </button>
</div>
